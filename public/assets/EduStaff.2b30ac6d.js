import{d as te,V as ue,r as V,a as h,z as ae,q as C,w as l,L as v,X as g,e as o,o as r,b as u,u as b,O as le,c as y,n as R,F as T,G as ne,h as A,t as S,D as oe,f as M,i as F,A as I,E as w,M as $,_ as se}from"./index.a6fce3c1.js";const ie=F("\u65B0\u589E"),re={key:0},de={key:1,style:{color:"#CDD0D6"}},_e={key:0,style:{color:"#409EFF"}},ce={key:1,style:{color:"#F56C6C"}},fe=F("\u7F16\u8F91"),me=F("\u5165\u804C"),pe=F("\u79BB\u804C"),ge={class:"dialog-footer"},ye=F("\u53D6\u6D88"),Fe=F("\u4FDD\u5B58"),Ee=te({__name:"EduStaff",setup(De){ue();const E=V([]),z=V([]),k=h([]),x=V(null),P=V(null),c=h({total:0,currentPage:1}),a=h({isEdit:!1,editType:0,model:{stf_id:0,stf_name:"",stf_category:0,stf_remark:""}}),i=h({stf_id:0,stf_category:0,stf_name:"",begin:0,pageSize:5}),d=async(n=!0)=>{n&&(c.currentPage=1),i.begin=(c.currentPage-1)*i.pageSize,await v([()=>new Promise((t,s)=>{g.get(i).then(_=>{const{total:f,list:D}=_;if(f>0&&D.length===0){c.currentPage=Math.ceil(f/i.pageSize),d(!1);return}E.value=D,c.total=f,t(null)}).catch(()=>s())}),()=>new Promise((t,s)=>{g.getDic().then(_=>{z.value=_,t(null)}).catch(()=>s())})])};ae(async()=>{console.log(E);try{await d(),z.value.forEach(n=>{n.dic_group_key==="staff_category"&&k.push(n)})}catch{}});const L=async n=>{try{await I.confirm(`\u786E\u5B9A\u5C06\u201C${n.stf_name}\u201D\u7684\u5458\u5DE5\u72B6\u6001\u6539\u4E3A\u79BB\u804C\uFF1F`,"Warning",{type:"warning",confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}),await v([()=>g.setDimission(n.stf_id),()=>d()],!0),w({type:"success",message:`"${n.stf_name}"\u7684\u5458\u5DE5\u72B6\u6001\u5DF2\u66F4\u6539\u4E3A\u79BB\u804C\uFF01`})}catch{}},q=async n=>{try{await I.confirm(`\u786E\u5B9A\u5C06\u201C${n.stf_name}\u201D\u7684\u5458\u5DE5\u72B6\u6001\u6539\u4E3A\u5728\u804C\uFF1F`,"Warning",{type:"warning",confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}),await v([()=>g.setReinstate(n.stf_id),()=>d()],!0),w({type:"success",message:`"${n.stf_name}"\u7684\u5458\u5DE5\u72B6\u6001\u5DF2\u66F4\u6539\u4E3A\u5728\u804C\uFF01`})}catch{}},N=async()=>{a.model.stf_id=0,a.model.stf_name="",a.model.stf_category=0,a.model.stf_remark="",await $(()=>a.isEdit=!0)},W=async n=>{a.model.stf_id=n.stf_id,a.model.stf_name=n.stf_name,a.model.stf_category=n.stf_category,a.model.stf_remark=n.stf_remark,await $(()=>a.isEdit=!0)},j=async()=>{var n;a.model.stf_id===0?(await((n=x.value)==null?void 0:n.validateField()),await v([()=>g.add(a.model),()=>d()],!0),w({message:`\u7528\u6237"${a.model.stf_name}"\u6DFB\u52A0\u6210\u529F\uFF01`,type:"success"}),a.isEdit=!1,await $(()=>{let t=E.value.findIndex(s=>s.stf_name===a.model.stf_name);P.value.setCurrentRow(E.value[t])})):(await v([()=>g.update(a.model),()=>d(!1)],!0),w({message:`\u7528\u6237"${a.model.stf_name}"\u4FEE\u6539\u6210\u529F\uFF01`,type:"success"}),a.isEdit=!1)},G={stf_name:[{required:!0,message:"* \u5458\u5DE5\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A\uFF01",trigger:"blur"},{min:2,max:20,message:"* \u5458\u5DE5\u59D3\u540D\u5E94\u4E3A2-20\u4E4B\u95F4\uFF01",trigger:"blur"}],stf_category:[{required:!0,validator:(n,t,s)=>{if(t===0)s(new Error("* \u8BF7\u9009\u62E9\u5458\u5DE5\u7C7B\u578B\uFF01"));else{if(a.model.stf_category!==null){if(!x.value)return;x.value.validateField("checkPass",()=>null)}s()}},trigger:"blur"}]},O=n=>(c.currentPage-1)*i.pageSize+n+1;return(n,t)=>{const s=o("el-input"),_=o("el-form-item"),f=o("el-option"),D=o("el-select"),m=o("el-button"),U=o("el-form"),X=o("el-header"),p=o("el-table-column"),H=o("el-table"),J=o("el-dialog"),K=o("el-main"),Q=o("el-pagination"),Y=o("el-footer"),Z=o("el-container");return r(),C(Z,null,{default:l(()=>[u(X,null,{default:l(()=>[u(U,{inline:""},{default:l(()=>[u(_,{label:"\u5458\u5DE5\u540D\u79F0:"},{default:l(()=>[u(s,{"prefix-icon":b(le),modelValue:i.stf_name,"onUpdate:modelValue":t[0]||(t[0]=e=>i.stf_name=e),placeholder:"\u8BF7\u8F93\u5165\u5458\u5DE5\u59D3\u540D",onChange:t[1]||(t[1]=e=>d())},null,8,["prefix-icon","modelValue"])]),_:1}),u(_,{label:"\u5458\u5DE5\u7C7B\u578B:"},{default:l(()=>[u(D,{modelValue:i.stf_category,"onUpdate:modelValue":t[2]||(t[2]=e=>i.stf_category=e),onChange:t[3]||(t[3]=e=>d())},{default:l(()=>[u(f,{value:0,label:"- \u8BF7\u9009\u62E9 -"}),(r(!0),y(T,null,R(k,e=>(r(),C(f,{value:e.dic_id,label:e.dic_name,key:e.dic_id},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(_,{style:{color:"#ffffff"}},{default:l(()=>[u(m,{type:"primary",icon:b(ne),style:{width:"200px"},onClick:N},{default:l(()=>[ie]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1}),u(K,null,{default:l(()=>[u(H,{data:E.value,border:"",stripe:"","highlight-current-row":"",ref_key:"tableRef",ref:P},{default:l(()=>[u(p,{label:"#",index:O,prop:"#",type:"index",align:"center"}),u(p,{label:"\u59D3\u540D",align:"center",prop:"stf_name"}),u(p,{label:"\u804C\u52A1\u7C7B\u578B",align:"center"},{default:l(({row:e})=>{var B;return[A("span",null,S((B=k.find(ee=>ee.dic_id===e.stf_category))==null?void 0:B.dic_name),1)]}),_:1}),u(p,{label:"\u5907\u6CE8",align:"center"},{default:l(({row:e})=>[e.stf_remark!==""?(r(),y("span",re,S(e.stf_remark),1)):(r(),y("span",de,"\u6682\u65E0\u76F8\u5173\u5907\u6CE8"))]),_:1}),u(p,{label:"\u5458\u5DE5\u72B6\u6001",align:"center"},{default:l(({row:e})=>[e.stf_invalid===1?(r(),y("span",_e,"\u5728\u804C")):(r(),y("span",ce,"\u79BB\u804C"))]),_:1}),u(p,{label:"\u64CD\u4F5C",align:"center"},{default:l(({row:e})=>[u(m,{type:"primary",icon:b(oe),onClick:B=>W(e)},{default:l(()=>[fe]),_:2},1032,["icon","onClick"]),e.stf_invalid===0?(r(),C(m,{key:0,type:"success",icon:b(M),onClick:B=>q(e)},{default:l(()=>[me]),_:2},1032,["icon","onClick"])):(r(),C(m,{key:1,type:"danger",icon:b(M),onClick:B=>L(e)},{default:l(()=>[pe]),_:2},1032,["icon","onClick"]))]),_:1})]),_:1},8,["data"]),u(J,{modelValue:a.isEdit,"onUpdate:modelValue":t[8]||(t[8]=e=>a.isEdit=e),width:"500px",center:"",draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{header:l(()=>[A("span",null,S(a.model.stf_id===0?"\u5458\u5DE5\u65B0\u589E":"\u5458\u5DE5\u4FE1\u606F\u7F16\u8F91"),1)]),footer:l(()=>[A("span",ge,[u(m,{onClick:t[7]||(t[7]=e=>a.isEdit=!1)},{default:l(()=>[ye]),_:1}),u(m,{type:"primary",onClick:j},{default:l(()=>[Fe]),_:1})])]),default:l(()=>[u(U,{ref_key:"formRef",ref:x,model:a.model,"status-icon":"",rules:G,"label-width":"120px"},{default:l(()=>[u(_,{label:"\u5458\u5DE5\u59D3\u540D\uFF1A",prop:"stf_name"},{default:l(()=>[u(s,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:a.model.stf_name,"onUpdate:modelValue":t[4]||(t[4]=e=>a.model.stf_name=e)},null,8,["modelValue"])]),_:1}),u(_,{label:"\u5458\u5DE5\u7C7B\u578B\uFF1A",prop:"stf_category"},{default:l(()=>[u(D,{modelValue:a.model.stf_category,"onUpdate:modelValue":t[5]||(t[5]=e=>a.model.stf_category=e)},{default:l(()=>[u(f,{label:"- \u65E0\u89D2\u8272 -",value:0}),(r(!0),y(T,null,R(k,e=>(r(),C(f,{key:e.dic_id,label:e.dic_name,value:e.dic_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(_,{label:"\u5458\u5DE5\u5907\u6CE8\uFF1A"},{default:l(()=>[u(s,{type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u76F8\u5173\u5907\u6CE8",modelValue:a.model.stf_remark,"onUpdate:modelValue":t[6]||(t[6]=e=>a.model.stf_remark=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1}),u(Y,null,{default:l(()=>[u(Q,{background:"",layout:"pre,pager,next,jumper,->,sizes, total","page-sizes":[5,9,14,18,22],total:c.total,"page-size":i.pageSize,"onUpdate:page-size":t[9]||(t[9]=e=>i.pageSize=e),"current-page":c.currentPage,"onUpdate:current-page":t[10]||(t[10]=e=>c.currentPage=e),onSizeChange:t[11]||(t[11]=e=>d()),onCurrentChange:t[12]||(t[12]=e=>d(!1))},null,8,["total","page-size","current-page"])]),_:1})]),_:1})}}});const ve=se(Ee,[["__scopeId","data-v-fe509c60"]]);export{ve as default};
