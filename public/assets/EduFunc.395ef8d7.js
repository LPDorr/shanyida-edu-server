import{d as z,B as H,v as R,r as q,a as G,y as J,z as W,c as D,b as a,w as s,u as c,F as E,e as d,o as _,h as p,q as b,C as j,s as K,t as O,D as P,G as Q,H as X,n as h,I as Y,J as Z,i as A,A as ee,L as r,E as w,M as C,p as ue,g as ne,_ as le}from"./index.a6fce3c1.js";const ae={func:"\u529F\u80FD\u7BA1\u7406\u6A21\u5757",rolefunc:"\u89D2\u8272\u7BA1\u7406\u53CA\u7528\u6237\u89D2\u8272\u5206\u914D\u6A21\u5757",userrole:"\u7528\u6237\u7BA1\u7406\u53CA\u7528\u6237\u89D2\u8272\u5206\u914D\u6A21\u5757",classroom:"\u6559\u5BA4\u7BA1\u7406\u6A21\u5757",class:"\u73ED\u7EA7\u7BA1\u7406\u6A21\u5757",student:"\u5B66\u751F\u7BA1\u7406\u6A21\u5757",staff:"\u4EBA\u5458\u7BA1\u7406\u6A21\u5757",password:"\u5BC6\u7801\u7BA1\u7406\u6A21\u5757"},oe=F=>(ue("data-v-6a93f9c7"),F=F(),ne(),F),se={class:"custom-tree-node"},te={class:"left"},de={style:{"font-size":"14px"}},ie={class:"right"},ce=oe(()=>p("span",{class:"dialog-header"},"\u529F\u80FD\u7F16\u8F91",-1)),fe=A("\u975E\u53F6\u5B50\u8282\u70B9"),_e=A("\u53F6\u5B50\u8282\u70B9"),re=A("\u53D6\u6D88"),me=A("\u786E\u5B9A"),pe=z({__name:"EduFunc",setup(F){const t=H(),g=R(),m=q(null),e=G({isEdit:!1,isLeaf:!1,model:{func_id:0,func_name:"",func_key:"",func_fid:-1}});J(()=>e.isLeaf,l=>{l||(e.model.func_key="")}),W(async()=>{await t.init()});const x=async l=>{await ee.confirm(`\u786E\u5B9A\u8981\u5220\u9664\u201C${l.func_name}\u201D\u5417\uFF1F`,"Warning",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",showClose:!1}),await r([()=>t.removeHandler(l.func_id),()=>r([()=>g.getMenu(),()=>t.init()])]),await w({type:"success",message:`\u5220\u9664\u201C${l.func_name}\u201D\u6210\u529F\uFF01\u8BF7\u5237\u65B0\u9875\u9762~`})},V=l=>{var u;e.model={func_id:0,func_name:"",func_key:"",func_fid:l.func_id},e.isLeaf=!1,(u=m.value)==null||u.resetFields(),C(()=>e.isEdit=!0)},L=l=>{var u;e.model={func_id:l.func_id,func_name:l.func_name,func_key:l.func_key,func_fid:l.func_fid},e.isLeaf=l.func_key!=="",(u=m.value)==null||u.resetFields(),C(()=>e.isEdit=!0)},M=async()=>{var l;try{e.model.func_id===0?(await((l=m.value)==null?void 0:l.validate()),await r([()=>t.add(e.model),()=>r([()=>g.getMenu(),()=>t.init()])])):await r([()=>t.update(e.model),()=>r([()=>g.getMenu(),()=>t.init()])])}catch{}w({message:"\u7F16\u8F91\u6210\u529F",type:"success"}),e.isEdit=!1},S={func_name:[{validator:(l,u,o)=>{u.length===0?o(new Error("* \u529F\u80FD\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!")):u.length<2||u.length>50?o(new Error("* \u529F\u80FD\u540D\u79F0\u957F\u5EA6\u5E94\u4E3A2-50\u4E4B\u95F4!")):t._allFuncs.some(i=>i.func_id!==e.model.func_id&&i.func_name===u&&i.func_fid===e.model.func_fid)?o(new Error(`* \u5F53\u524D\u7236\u8282\u70B9\u4E0B\u5DF2\u5B58\u5728\u201C${u}\u201D\u8282\u70B9!`)):o()},trigger:"blur"}],func_fid:[{validator:(l,u,o)=>{var i;e.model.func_fid!==0&&((i=m.value)==null||i.validateField("func_name",()=>null)),o()},trigger:"change"}],func_key:[{validator:(l,u,o)=>{e.isLeaf&&u===""?o(new Error("* \u53F6\u5B50\u8282\u70B9\u4E0B\u5FC5\u987B\u9009\u62E9\u529F\u80FD\u6A21\u5757!")):o()},trigger:"change"}]};return(l,u)=>{const o=d("el-button"),i=d("el-tree"),v=d("el-radio"),$=d("el-radio-group"),B=d("el-form-item"),y=d("el-option"),k=d("el-select"),I=d("el-input"),U=d("el-form"),N=d("el-dialog");return _(),D(E,null,[a(i,{data:c(t).treeData,class:"custom-tree","default-expand-all":"","expand-on-click-node":!1},{default:s(({data:n})=>[p("span",se,[p("span",te,[n.func_key!==""?(_(),b(o,{key:0,type:"text",icon:c(j),style:{margin:"0 3px 0 5px"}},null,8,["icon"])):K("",!0),p("span",de,O(n.func_name),1)]),p("span",ie,[a(o,{type:"primary",icon:c(P),disabled:[0,1,2].includes(n.func_id),onClick:f=>L(n)},null,8,["icon","disabled","onClick"]),a(o,{type:"primary",icon:c(Q),disabled:n.func_key!=="",onClick:f=>V(n)},null,8,["icon","disabled","onClick"]),a(o,{type:"primary",onClick:f=>x(n),icon:c(X),disabled:[0,1,2].includes(n.func_id)},null,8,["onClick","icon","disabled"])])])]),_:1},8,["data"]),a(N,{"model-value":e.isEdit,width:"500px",center:"",draggable:"","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},{header:s(()=>[ce]),footer:s(()=>[a(o,{onClick:u[4]||(u[4]=n=>e.isEdit=!1)},{default:s(()=>[re]),_:1}),a(o,{type:"primary",onClick:M},{default:s(()=>[me]),_:1})]),default:s(()=>[a(U,{"label-width":"120px",model:e.model,rules:S,ref_key:"formRef",ref:m,"status-icon":""},{default:s(()=>[a(B,{label:"\u529F\u80FD\u7C7B\u578B\uFF1A"},{default:s(()=>[a($,{modelValue:e.isLeaf,"onUpdate:modelValue":u[0]||(u[0]=n=>e.isLeaf=n),disabled:e.model.func_id!==0},{default:s(()=>[a(v,{label:!1},{default:s(()=>[fe]),_:1}),a(v,{label:!0},{default:s(()=>[_e]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),a(B,{label:"\u7236\u7EA7\u529F\u80FD\uFF1A",prop:"func_fid"},{default:s(()=>[a(k,{modelValue:e.model.func_fid,"onUpdate:modelValue":u[1]||(u[1]=n=>e.model.func_fid=n),disabled:e.model.func_id===0},{default:s(()=>[a(y,{label:"Root",value:0}),(_(!0),D(E,null,h(c(t).noLeafFunc,n=>(_(),b(y,{label:n.func_name,value:n.func_id,disabled:n.func_id===e.model.func_id,key:n.func_id},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(B,{label:"\u529F\u80FD\u540D\u79F0\uFF1A",prop:"func_name"},{default:s(()=>[a(I,{modelValue:e.model.func_name,"onUpdate:modelValue":u[2]||(u[2]=n=>e.model.func_name=n),modelModifiers:{lazy:!0,trim:!0}},null,8,["modelValue"])]),_:1}),Y(a(B,{label:"\u529F\u80FD\u6A21\u5757\uFF1A",prop:"func_key"},{default:s(()=>[a(k,{modelValue:e.model.func_key,"onUpdate:modelValue":u[3]||(u[3]=n=>e.model.func_key=n)},{default:s(()=>[a(y,{value:"",label:"- \u8BF7\u9009\u62E9 -"}),(_(!0),D(E,null,h(c(ae),(n,f)=>(_(),b(y,{label:n,value:f,disabled:c(t)._allFuncs.findIndex(T=>T.func_key===f)!==-1,key:f},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[Z,e.isLeaf]])]),_:1},8,["model"])]),_:1},8,["model-value"])],64)}}});const Be=le(pe,[["__scopeId","data-v-6a93f9c7"]]);export{Be as default};
